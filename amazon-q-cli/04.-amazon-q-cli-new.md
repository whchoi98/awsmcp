# 04. Amazon Q CLI 시작하기 (NEW)

## 🚀 Amazon Q CLI 시작하기 (Exploring Amazon Q CLI)

이 랩에서는 **Amazon Q CLI**의 기능들을 살펴봅니다.

***

### 🧩 명령어 자동 완성 (Command Line Completion)

명령어 자동 완성 기능은 Amazon Q CLI를 전체 설치했을 경우에만 사용할 수 있습니다. 이 기능은 자주 사용하는 명령어에 대해 다양한 옵션을 제시해주는 도우미 역할을 합니다. 예를 들어, AWS CLI, Docker, Git 등의 명령어 입력 시 보조 기능을 제공합니다.

터미널에서 명령어를 입력하면, 이제 어떤 명령어 옵션을 사용할지에 대한 추천이 표시됩니다.

* ↑, ↓ 키로 옵션 탐색 가능
* 입력을 계속하면 옵션이 자동으로 필터링됨
* ESC 키를 누르면 추천 옵션 창을 종료할 수 있음

🧪 **데모: 명령어 자동 완성 (command line completion)**

#### 🧪 Task-01

1. 터미널을 열고 `git` 입력 후 스페이스를 누르세요. 어떤 일이 일어나는지 확인해보세요.
2. ↑, ↓ 키로 항목을 탐색하고 ENTER 키로 선택
3. `git push`까지 입력한 후 스페이스를 누르면, 관련 옵션이 더 좁혀짐
4. `docker`, `java`, `dotnet` 명령어 등도 시도해보세요.
5. ESC 키로 메뉴를 종료하고 계속 입력할 수 있습니다.

***

### 🧩  명령어 자동 제안 (Command Line Auto Suggestion)

Amazon Q CLI는 단순한 보조 기능을 넘어, 사용자가 입력한 내용을 분석해 문맥에 맞는 명령어를 제안합니다.

***

### 🧩  명령어 번역 (Command Line Translation)

CLI 툴을 사용할 때 필요한 다양한 매개변수를 자주 잊어버리곤 합니다. 이제는 `--help`를 사용하는 대신, **명령어 번역** 기능을 통해 원하는 작업을 자연어로 설명하면 Amazon Q CLI가 이를 명령어로 변환해 줍니다.

사용 방법:

```bash
q ai "하고자 하는 작업 설명"
q translate "의도"
```

#### 🧪 Task-02

터미널에서 다음을 입력하세요:

```bash
q ai “이 디렉터리 및 모든 하위 디렉터리에서 가장 큰 파일 3개를 찾아줘.”
```

몇 초 후 다음과 같은 결과가 나타납니다:

```bash
find . -type f -exec du -h {} \; | sort -rh | head -n 3

> 현재 디렉터리 및 모든 하위 디렉터리에서 가장 큰 파일 3개는 다음과 같습니다:

1. ./q.zip - 173MB
2. ./q/bin/q - 99MB
3. ./.local/bin/q - 99MB

첫 번째로 큰 파일은 q.zip 파일이고, 나머지 두 파일은 q 실행 파일로 보입니다. 하나는 q 디렉터리 내에 있고 다른 하나는 숨겨진 .local 디렉터리의 bin 
폴더에 있습니다.
```

* ↑, ↓ 키로 선택 가능
* ENTER 키로 실행
* `Edit`를 선택해 명령어 수정 후 실행 가능
* `Regenerate`로 다른 제안 요청 가능

익숙한 명령어들로 여러 번 실험해보세요.

***

### 🧩  인터랙티브 채팅 (Interactive / Agentic Chat)

Amazon Q CLI는 명령어 실행 외에도 자연어 기반 채팅이 가능한 **Chat 모드**를 제공합니다.

다음 명령으로 진입:

```bash
q
q chat
```

또는 다음과 같이 직접 질문 입력:

```bash
q "Python Flask 애플리케이션을 실행하는 Dockerfile을 보여줘."
```

Amazon Q CLI는 다음과 같은 구성을 불러옵니다:

* **전역 설정 (Global Configurations)**: `settings.json` 파일 (예: `q settings` 명령어로 수정 가능)
* **세션 설정 (Session Configuration)**: MCP 서버, 컨텍스트 리소스, 툴 권한 등 포함

***

### 🧩Amazon Q CLI 커스텀 에이전트 (Custom Agents)

Amazon Q CLI 도구의 v1.13.1부터는, Amazon Q CLI 채팅 세션을 시작할 때 “커스텀 에이전트(custom agent)” 구성이라는 것을 불러오게 됩니다.&#x20;

Amazon Q CLI는 Custom Agent(커스텀 에이전트)라는 것을 생성할 수 있게 해주며, 이는 리소스(resources), 도구(tools), 컨텍스트(context) 등을 정의할 수 있는 구성 저장소 역할을 합니다.

지금은 자세히 다루지 않지만,  중요한 점은 다음과 같습니다:

q chat 명령어를 아무 인자 없이 실행하면, 기본 에이전트 구성인 `q_cli_default`가 로드된다는 점입니다.

특정 커스텀 에이전트로 Amazon Q CLI 채팅을 시작하고 싶다면, `--agent {에이전트_이름}` 인자를 사용하면 됩니다.

예를 들어, php-dev라는 이름의 커스텀 에이전트를 만들었다면 아래와 같은 명령어로 시작할 수 있습니다:

```
q chat --agent php-dev
```

이 명령은 기본 에이전트가 아닌, php-dev 구성으로 CLI 세션을 시작합니다.

이후에 커스텀 에이전트(Custom Agents)에 대해 더 자세히 살펴보게 될 것입니다.

기본값: `q_cli_default`

특정 에이전트로 시작하려면:

```bash
q chat --agent php-dev
```

#### ✅ Task-03

```bash
q
```

agent list 조회:

```bash
/agent list
```

채팅 종료:

* `/q`
* `CTRL + C`

***

### 🧩 에이전트 기능 활용 (Agentic Capabilities)

Amazon Q CLI는 단순히 프롬프트에 응답하는 것 이상을 수행하며, 완전한 에이전트 기능을 갖추고 있습니다.

입력한 프롬프트를 받아 작업(task) 단위로 분해한 뒤, 해당 작업들을 실제로 수행합니다.

Amazon Q CLI를 사용하기 시작하면 `"Thinking..."`이라는 메시지를 보게 될 텐데, 이는 도구가 사용자의 요청을 바탕으로 작업을 수행 중임을 나타냅니다.

작업이 진행되는 중에는 다음과 같은 방식으로 사용자와 상호작용합니다:

* 추가 입력이 필요한 경우
* 특정 작업을 실행하기 전에 확인이 필요한 경우
* 작업 상태를 알려줄 필요가 있는 경우

#### 🧪  Task-04

```bash
파일을 생성하지 않고, 최신 버전의 Python을 사용하여 Python Flask 애플리케이션을 실행하기 위한 최적화된 Dockerfile을 보여줘.
```

***

### 🧩 도구 권한 (Tools & Permissions)

이전 프롬프트에서 `“파일을 생성하지 않고”` 라는 문구를 의도적으로 넣은 이유는, Amazon Q CLI에게 단순히 보여주기만 하도록 요청했기 때문입니다. 하지만 Amazon Q CLI는 그 이상의 능력을 가지고 있습니다.

Amazon Q CLI에는 “Tools(도구)”라는 개념이 있으며, 이를 통해 외부 환경과 상호작용할 수 있습니다.

이와 동시에, 사용자가 도구 사용에 대한 제어권(control)을 가질 수 있도록, “도구 권한(Permissions)”이라는 개념도 함께 존재합니다.

도구는 다음 두 가지 상태로 설정됩니다:

* Trusted(신뢰됨)
* Untrusted(신뢰되지 않음)

즉, Amazon Q CLI가 어떤 Tool을 사용하려고 할 때, 그 Tool이 `“Untrusted”` 상태라면, 실행 여부에 대해 사용자의 허락을 요청하게 됩니다.

이때 사용자는 다음 중 하나를 선택할 수 있습니다:

* 이번 한 번만 허용
* 앞으로 항상 허용
* 거부

기본적으로, Amazon Q CLI는 읽기(Read) 작업만 수행하는 내장 도구(Built-In Tool)에 대해서는 자동으로 신뢰합니다.

그러나 파일 시스템에 쓰거나(Write), 명령어나 프로그램을 실행(execute)하는 도구는 기본적으로 신뢰하지 않도록 설정되어 있습니다.

왜 이게 중요할까요?

예를 들어, 사용자가 대규모 프로젝트에서 작업 중이라면, 여러 파일을 생성하거나 프로그램을 실행하는 일이 잦을 수 있습니다.

이때 모든 작업마다 도구 사용을 수동으로 허가해야 한다면 매우 번거롭겠죠.

따라서 도구의 신뢰 상태를 조정할 수 있는 제어 기능은, 필요한 상황에서는 자동으로 승인하도록 설정함으로써, 더 효율적인 작업을 가능하게 합니다.

이제 도구 권한(Tools Permissions)을 살펴보고, 앞서 수행한 작업을 확장함으로써 이것이 실제로 어떻게 작동하는지 확인해봅니다.

Amazon Q CLI는 외부 환경과 상호작용할 수 있는 **도구(Tools)** 개념을 지원하며, 이들에 대해 신뢰 수준(Permission)을 설정할 수 있습니다.

기본적으로 **읽기 전용(Read-only)** 도구는 자동 신뢰, **쓰기**(Write)**/실행**(execute) 도구는 사용자의 확인 필요

도구 목록 보기:

```bash
/tools
```

출력 예시:

```
> /tools

Tool              Permission
▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔
Built-in:
- use_aws         * trust read-only commands
- report_issue    * trusted
- fs_read         * trusted
- fs_write        * not trusted
- execute_bash    * trust read-only commands


```

#### 🧪 Task-05

다음과 같은 점을 알 수 있습니다:

Amazon Q CLI에는 자동으로 신뢰되는 두 가지 도구(Tools)가 있습니다:

* `fs_read`: Amazon Q CLI가 로컬 파일 시스템의 파일을 읽을 수 있도록 허용합니다.
* `report_issue`: Amazon Q CLI를 사용하다가 발생한 문제를 GitHub 프로젝트 저장소에 이슈로 자동 생성할 수 있게 해줍니다.

반면, 다음과 같은 도구는 기본적으로 신뢰되지 않습니다:

* &#x20;파일을 작성(`fs_write`)하는 도구
* &#x20;파일을 실행(`execute_bash`)하는 도구

이 의미는 만약 Amazon Q CLI가 위 도구들을 사용하려고 시도하면, 사용자에게 실행 허가를 요청하는 프롬프트가 뜨게 된다는 뜻입니다.

이제 실제로 어떻게 작동하는지 확인해보겠습니다.

아래 프롬프트를 입력해보세요:

```bash
Python Flask 애플리케이션을 실행하기 위한 최적화된 Dockerfile을 생성해줘. 최신 버전의 Python을 사용해야 합니다.
```

* `fs_write` 도구 사용을 허용할지 묻는 메시지가 출력됩니다. `t`를 눌러 항상 신뢰 설정.

이전과 유사한 출력이 생성된 것을 확인할 수 있지만, 이번에는 fs\_write 도구를 신뢰할지 여부를 묻는 프롬프트가 나타납니다.

fs\_write는 파일을 작성(write)\* 때 사용되는 도구입니다.

여기서 선택할 수 있는 옵션은 다음과 같습니다:

* y → 이번 한 번만 허용
* n → 거부
* t → 항상 신뢰 (다음부터는 묻지 않음)

"t"를 입력하고 Enter 키를 누르면, Amazon Q CLI가 파일 생성을 완료하는 것을 볼 수 있습니다.

이와 함께 추가적인 파일들도 자동 생성될 수 있습니다.

이제 Amazon Q CLI를 종료하고, 생성된 파일들을 확인해보세요.

단, Amazon Q CLI를 종료한 뒤 다시 실행하면, 도구 신뢰 설정은 기본값으로 초기화된다는 점에 유의하세요.

도구와 신뢰(Trust)에 대한 더 깊은 내용은 이후 실습에서 다루게 됩니다.

***

### 🧩 멀티라인 프롬프트 (Multi-line Prompts)

지금까지는 Amazon Q CLI 채팅에서 \*\*한 줄짜리 프롬프트(single line prompt)\*\*만 사용해보았지만, 실제로는 여러 가지 방법으로 \*\*여러 줄 프롬프트(multi-line prompt)\*\*를 입력할 수 있습니다.

입력 방식:

* `CTRL + J`: 새 줄 입력 : 터미널 내에서 여러 줄을 작성할 때 매우 유용합니다.
* `\`로 줄 끝에 붙이면 다음 줄로 이동 가능 : 이는 터미널에 익숙한 많은 사용자들이 가장 자연스럽게 사용하는 방식입니다.

#### 🧪  Task-06

```
Python 코드를 작성할 때는 다음 지침을 따르세요:
- 웹 프레임워크로 Flask를 사용하세요.
- Flask의 애플리케이션 팩토리 패턴(Application Factory Pattern)**을 따르세요.
- 구성(Configuration)에는 **환경 변수(Environment Variables)**를 사용하세요.
- 데이터베이스 작업은 Flask-SQLAlchemy를 사용하여 구현하세요.
```

***

### 🧩 선호 편집기 설정 (Editor Configuration)

좋아하는 텍스트 편집기를 Amazon Q CLI에서 사용 가능. 환경 변수 설정:

```bash
export EDITOR=vim
export EDITOR="code -w"
export EDITOR="nano"
```

#### 🧪 Task-07

```bash
/editor
```

편집기에서 멀티라인 프롬프트 작성 → 저장 후 종료 → 처리 시작

***

### 🧩 이미지 사용 (Using Images in Prompt)

Amazon Q CLI는 프롬프트에 이미지를 포함하는 기능을 지원합니다.

즉, 프로젝트 작업 공간(workspace) 내의 이미지를 참조하여, Amazon Q CLI가 해당 이미지 기반으로 도와줄 수 있다는 뜻입니다.

예를 들어 다음과 같은 경우에 유용합니다:

* 아키텍처 다이어그램을 기반으로 인프라를 코드로 구현하고 싶을 때
* \*\*ERD(Entity Relationship Diagram)\*\*를 바탕으로 SQL 또는 데이터 모델을 생성하고자 할 때
* UI/디자인 시안을 참고하여 프로토타입 코드를 생성하고 싶을 때

이처럼 시각 자료를 기반으로 Amazon Q CLI가 작업을 이해하고 자동화할 수 있도록 돕습니다.

#### 🧪 Task-08

1. `xxx.png` → `data-model` 디렉토리에 복사
2. 다음 명령 실행:

```bash
data-model 디렉토리에 있는 example-erd.png 다이어그램을 기반으로 Python으로 샘플 데이터 모델을 생성해줘.
```

Amazon Q CLI가 이미지 분석 후 코드 생성

***

### 🧩 모델 선택 및 변경 (Selecting the Large Language Model)

Amazon Q CLI에서는 채팅 세션 중 어떤 언어 모델(Language Model)을 사용할지 선택할 수 있습니다.

기본적으로 세션이 시작되면 기본 모델(default model)이 자동으로 설정되며, 원한다면 특정 세션 중간에 모델을 바꾸거나, 모든 세션에 적용할 기본 모델을 설정할 수도 있습니다.

#### ✅ 모델 선택 방법 두 가지

1. 채팅 세션 시작 시 지정

```
q chat --model <모델이름>
```

2. 채팅 세션 중에 /model 명령어 사용

* \> 프롬프트에서 `/model` 입력
* 방향키(↑ ↓)를 이용하여 원하는 모델 선택

#### 📌 2025년 6월 기준 사용 가능한 모델:

* claude-3.5-sonnet
* claude-3.7-sonnet
* claude-4-sonnet

#### ⚠️ 주의: 모델 설정은 일시적입니다

* 세션을 종료하면 모델 설정은 기본값으로 되돌아갑니다.
* 기본 모델을 영구적으로 바꾸고 싶다면, settings 파일을 수정해야 합니다. (Advanced Setup에서 다룸)

#### 🧪 Task-09 실습

* Amazon Q CLI 실행:

```
q

```

* 프롬프트에서 다음 명령 입력:

```
/model
```

* 원하는 모델로 변경하고, 다양한 프롬프트를 시도해보세요.
* 채팅 세션 종료 후, 다음 명령으로 새로운 모델을 지정한 채 세션 시작:

```
q chat --model claude-4-sonnet
```

* 다시 `/model` 입력해보면 Claude v4 모델이 선택된 상태임을 확인할 수 있습니다.
* 이제 세션을 종료하고 다시 Amazon Q CLI를 실행한 후 /model을 실행하면,

모델이 기본값으로 되돌아간 것을 확인할 수 있습니다.

이 과정을 통해 Amazon Q CLI에서 어떤 모델을 언제, 어떻게 사용하는지 유연하게 제어할 수 있게 됩니다.

***

#### 🧩 Context Engineering (컨텍스트 엔지니어링)

Context(컨텍스트)는 Amazon Q CLI가 사용자가 입력한 프롬프트(prompt)와 함께 사용하여 출력(output)을 생성하는 데 활용하는 정보입니다.

Amazon Q CLI를 사용할 때 컨텍스트를 어떻게 관리하느냐가 좋은 결과물을 얻는 데 핵심적입니다.

이 섹션에서는 이에 대해 좀 더 자세히 살펴보겠습니다.

#### 🎯 컨텍스트는 무한하지 않다

\


컨텍스트는 무한한 자원이 아니며, 효율적으로 관리되어야 합니다.

Amazon Q CLI가 출력 생성을 위해 사용하는 \*\*“컨텍스트 윈도우(context window)”\*\*는 유한한 자원이며,

이는 \*\*토큰(tokens)\*\*이라는 단위로 측정됩니다.

토큰은 대형 언어 모델(Large Language Models, LLMs)이 텍스트를 처리할 때 사용하는 기본 단위입니다.

\


현재 Amazon Q CLI의 최대 컨텍스트 윈도우 크기는 200,000 토큰입니다.

***

#### 📉 컨텍스트가 많다고 무조건 좋은 것은 아니다

\


\*\*Stanford University(스탠퍼드 대학교)\*\*의 연구에 따르면,

컨텍스트 길이가 길어질수록 오히려 출력 품질이 저하되는 경향이 있습니다.

즉, 컨텍스트가 많다고 항상 좋은 것은 아니며,

적절하게 필요한 정보만 포함하는 것이 더 중요합니다.

***

#### 📂 Amazon Q CLI에서의 Context 설정: 리소스(Resources)

\


Amazon Q CLI에서는 컨텍스트로 사용할 정보를 \*\*“리소스(Resources)”\*\*라는 개념으로 관리합니다.

이 리소스는 \*\*Markdown 파일(.md)\*\*이며, 여러분의 로컬 파일 시스템 내에 존재합니다.

\


Amazon Q CLI를 시작할 때, \*\*에이전트 구성(agent configuration)\*\*을 참고하여

어떤 리소스를 컨텍스트로 불러올지를 결정합니다.

(에이전트 구성에 대해서는 나중에 자세히 다룹니다.)

***

#### 📎 기본 에이전트&#x20;

#### q\_cli\_default

#### 의 자동 설정 리소스

| 디렉토리 경로         | 파일 이름      | 설명                                        |
| --------------- | ---------- | ----------------------------------------- |
| 현재 디렉토리         | README.md  | Amazon Q CLI를 실행한 위치에서 README.md 파일을 찾습니다 |
| 현재 디렉토리         | AmazonQ.md | 동일하게 현재 디렉토리에서 AmazonQ.md 파일을 찾습니다        |
| .amazonq/rules/ | \*.md      | .amazonq/rules 디렉토리 아래의 모든 마크다운 파일을 포함합니다 |

***

#### 🛠️ 현재 적용된 Context 리소스 확인

\


Amazon Q CLI 채팅 세션 내에서 다음 명령어를 입력하면 현재 적용된 컨텍스트 리소스를 확인할 수 있습니다:

```
> /context show
```

출력 예시:

```
👤 Agent (q_cli_default):
    AmazonQ.md
    AGENTS.md
    README.md
    .amazonq/rules/**/*.md

No files in the current directory matched the rules above.
```

이 출력에서는 현재 기본 에이전트(q\_cli\_default) 구성이 적용되었고,

다음과 같은 파일 패턴을 사용하고 있다는 것을 보여줍니다:

* .amazonq/rules/\*\*/\*.md
* README.md
* AmazonQ.md

\


만약 여러분의 프로젝트 워크스페이스에 이러한 파일이 존재한다면,

Amazon Q CLI는 이를 읽고 컨텍스트로 자동 추가합니다.

그리고 해당 규칙에 \*\*일치한 파일 수(Matched)\*\*가 표시됩니다.

***

#### 🧪 Task-10

1. Amazon Q CLI 채팅 세션을 엽니다.
2. 프롬프트 >에서 다음 명령을 입력합니다:

```
/context show
```

👉 출력 결과가 위 예시와 유사한지 확인해보세요.

이전에 실습을 진행하면서 README.md 파일이 생성되었다면, 해당 항목이 “Matched”로 표시될 것입니다.

3. Amazon Q CLI를 종료합니다.
4.  현재 디렉토리에 AmazonQ.md 또는 README.md 파일을 새로 생성하세요.

    (내용은 비워두셔도 됩니다.)
5. 다시 Amazon Q CLI를 실행하고, /context show 명령어를 다시 입력합니다.

***

#### 🔍 무엇이 달라졌나요?

\


이번에는 Amazon Q CLI가 새로 생성된 파일들을 인식하고,

해당 리소스를 \*\*컨텍스트에 포함(Matched)\*\*시켰다는 것을 확인할 수 있어야 합니다.

***

이처럼 Amazon Q CLI의 출력 품질을 높이기 위해서는,

컨텍스트로 어떤 정보가 사용되는지 명확히 관리하고, 필요에 맞게 구성하는 것이 매우 중요합니다.



***

