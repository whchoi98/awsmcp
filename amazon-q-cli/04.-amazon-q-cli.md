# 04. Amazon Q CLI로 코드 작성하기

이번 장에서는 Amazon Q CLI를 활용해 실제로 애플리케이션을 설계하고 작성하는 전 과정을 실습합니다. 사전 설정한 컨텍스트와 프로필을 기반으로 어떻게 코드를 생성하고, 테스트하며, 실행까지 이어지는지를 단계별로 확인할 수 있습니다.

***

### 🧾 목표 개요

다음과 같은 기능을 갖춘 고객 피드백 설문 애플리케이션을 만들 것입니다.

* 사용자 등록 및 로그인 기능
* 로그인한 사용자만 설문 생성 가능
* 설문 링크를 통해 누구나 피드백 제출 가능
* 설문 소유자만 결과 확인 가능

이를 통해 Amazon Q CLI의 코드 생성 능력과 컨텍스트 기반 지능을 실제로 체험합니다.

***

### 📁 Task 01: 프로젝트 구조 및 스펙 컨텍스트 생성

<pre><code><strong>cd ~/projects
</strong><strong>mkdir qcli-app
</strong>cd qcli-app
</code></pre>

1. .amazonq/rules/1.project-layout-rules.md 작성:

```
Use the following project structure when writing code

src/
├── static/
├── models/
├── routes/
├── templates/
├── extensions.py
├── app.py
```

2. .amazonq/rules/2.project-spec.md 작성:

```
When creating Python code, use the following guidance

- Use Flask as the web framework
- Follow Flask's application factory pattern
- Use environment variables for configuration
- Implement Flask-SQLAlchemy for database operations
```

***

### 👤 Task 02: 전용 프로필 생성

```
q
> /profile create customer-survey-project
```

생성된 프로필 확인:

```
> /profile set customer-survey-project
```

***

### 🗃️ Task 03: 데이터 모델 컨텍스트 추가

1. data-model/database\_schema.yaml 파일 생성 (샘플 스키마)
2. 컨텍스트로 추가:

```
> /context add data-model/database_schema.yaml
> /context show
```

***

### ✍️ Task 04: 코딩 프롬프트 입력 (에디터 활용)

1. 환경 변수 설정:

```
export EDITOR=vi  # 또는 export EDITOR="code -w"
```

2. Amazon Q CLI 실행 후:

```
> /profile set customer-survey-project
> /editor
```

3. 아래 프롬프트 입력:

```
Build a simple Customer Survey application.

- Generate a web application that can be used in a browser
- Users will need to register with an email address to login
...
- Ensure the database is initialised properly
```

4. 코드 생성 → 필요한 도구 신뢰(t) → 자동 생성 진행

***

### 🧪 Task 05: 애플리케이션 실행

```
> Create a virtual python environment (.venv) and then install dependencies and run the application
```

성공 시 메시지:

```
* Running on http://127.0.0.1:5000
```

브라우저 열기 → 사용자 등록 → 로그인 → 설문 생성 → 공유 링크 확인

***

### 🛠️ 오류 디버깅

문제 발생 시:

```
> What does error [복사한 에러 메시지] mean
```

또는

```
> When doing xx, I get this error - [에러 메시지]
```

***

### ✅ Task 06: 테스트 코드 자동 생성

```
> Add unit tests to this project for the routes and models. Aim for 50% test coverage
```

* 테스트 코드 생성 및 실행
* 경고 메시지 개선 요청:

```
> Update the code to address LegacyAPIWarning: The Query.get() method...
```

***

### 📊 Task 07: 컨텍스트 사용량 검토

```
> /usage
```

토큰 사용량 확인 → 컨텍스트 최적화 필요 여부 판단

***

### ✅ 요약

이번 실습을 통해 Amazon Q CLI를 활용하여 다음을 수행했습니다:

* 프로젝트 초기 구조 및 스펙 정의
* 데이터 모델 기반 코드 생성
* 프로필 및 컨텍스트를 통한 맞춤형 응답
* 테스트 코드 자동 생성 및 개선

이제 Amazon Q CLI를 실질적인 개발 도구로 활용할 수 있는 기반이 갖추어졌습니다. 다음 장에서는 자동화(AI-Driven Automation)를 통해 반복 작업을 최적화하는 실습으로 이어집니다.
