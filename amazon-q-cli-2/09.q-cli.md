---
description: 'Update : 2025.07.20'
---

# 09.Q CLI 기반 플랫폼 운영 환경 설정

{% hint style="warning" %}
Amazon Q CLI 기반 플랫폼 운영하기 목차를 수행하기 위해서는, AWS 자원이 배포 됩니다. 따라서 비용이 발생할 수 있기 때문에 주의가 필요합니다.
{% endhint %}

## 🧩 Amazon Q CLI 실습 환경 구성

Amazon Q CLI의 고급 기능을 실습할 수 있는 클라우드 기반 환경을 자동으로 구성합니다. 네트워크 인프라부터 개발 도구, AI 통합 도구(MCP)까지 포함된 종합적 학습 환경입니다.

***

### 🧪 아키텍처 구성

#### ✅ 네트워킹 인프라

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│    DMZ VPC      │    │     VPC01       │    │     VPC02       │
│  (Public/NAT)   │    │   (Private)     │    │   (Private)     │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │
          └──────────────────────┼──────────────────────┘
                                 │
                    ┌─────────────┴─────────────┐
                    │    Transit Gateway        │
                    │   (Cross-VPC Routing)     │
                    └───────────────────────────┘
```

#### ✅ 서비스 구성 요약

* **DMZ VPC**: Public Subnet, NAT Gateway, Redis, OpenSearch (Option)
* **VPC01**: Private Subnet, Aurora MySQL
* **VPC02**: 추가 워크로드용 Private Subnet
* **선택사항**: Amazon EKS (K8s 환경)

***

### 🧪 빠른 시작

#### ✅ 저장소 클론 및 이동

```bash
git clone https://github.com/whchoi98/amazonqcli_lab.git
cd amazonqcli_lab/LabSetup
```

#### ✅ 인프라 자동 배포

3개의 VPC를 배포합니다.

```bash
./0.depoly-all-vpcs.sh     # 병렬 VPC 배포

```

VPC간의 연결 구성을 TGW를 통해서 구성합니다.

```
./0.deploy-tgw.sh          # Transit Gateway 배포

```

✅ 개발 환경 구성

```bash
./1.vscode-tools-installer.sh
./2.set-aws-env.sh
./3.kms-setup.sh
```

#### ✅ Amazon Q CLI 및 MCP 설정

```bash
./4.install_core_mcp.sh
./5.setup-mcp-config.sh
```

***

### 🧪 상세 배포 가이드 소개

#### 🧪 Phase 1: 네트워킹 인프라

**✅ VPC 구성 (0.depoly-all-vpcs.sh)**

* DMZ VPC: Public/NAT 서브넷, IGW, NATGW
* VPC01/VPC02: Private 서브넷, 라우팅 테이블
* 병렬 배포, S3 업로드 포함

**✅ Transit Gateway 설정 (0.deploy-tgw.sh)**

* TGW 생성 및 VPC 연결
* TGW 라우팅 테이블 설정

#### 🧪 Phase 2: 개발 환경

**✅ 개발 도구 설치 (1.vscode-tools-installer.sh)**

* AWS CLI, kubectl, eksctl, helm, k9s
* jq, fzf, bash-completion 등

**✅ AWS 환경 구성 (2.set-aws-env.sh)**

* 프로파일 및 리전 변수 설정

**✅ KMS 키 구성 (3.kms-setup.sh)**

* 암호화용 KMS 키 및 별칭 구성

#### 🧪 Phase 3: Amazon Q CLI 및 MCP

**✅ 런타임 설치 (4.install\_core\_mcp.sh)**

* Python 3.12, uv, Node.js 설치

**✅ MCP 서버 구성 (5.setup-mcp-config.sh)**

* MCP 구성 파일 생성
* Amazon Q CLI와 연동

***

### 🧪 선택적 서비스 배포

<table><thead><tr><th>🔗 서비스</th><th>🌐 위치</th><th>🖥️ 배포 스크립트</th><th>🧾 템플릿</th></tr></thead><tbody><tr><td>Redis (ElastiCache)</td><td>DMZ VPC</td><td><code>./0.deploy-redis.sh</code></td><td><code>redis-cluster-stack.yml</code></td></tr><tr><td>Aurora MySQL</td><td>VPC01</td><td><code>./0.deploy-aurora.sh</code></td><td><code>aurora-mysql-stack.yml</code></td></tr><tr><td>OpenSearch</td><td>DMZ VPC</td><td><code>./deploy-opensearch.sh</code></td><td><code>opensearch-stack.yml</code></td></tr><tr><td>Amazon EKS</td><td>DMZ VPC</td><td><p></p><pre><code>./dmz_eks_shell.sh

# eksctl 구성 및 배포
./dmz_eksctl_shell.sh

# 클러스터 구성 확인 (dry-run)
eksctl create cluster --config-file=/home/ec2-user/amazonqcli_lab/LabSetup/eksworkshop.yaml --dry-run

# 실제 클러스터 생성
eksctl create cluster --config-file=/home/ec2-user/amazonqcli_lab/LabSetup/eksworkshop.yaml
</code></pre></td><td><code>eksworkshop.yaml</code></td></tr></tbody></table>

***

### 🧪 디렉터리 구조

```
LabSetup/
├── 배포 스크립트
│   ├── 0.depoly-all-vpcs.sh
│   ├── 0.deploy-tgw.sh
│   ├── 0.deploy-redis.sh
│   └── 0.deploy-aurora.sh
├── 환경 설정
│   ├── 1.vscode-tools-installer.sh
│   ├── 2.set-aws-env.sh
│   └── 3.kms-setup.sh
├── MCP 및 Q CLI 설정
│   ├── 4.install_core_mcp.sh
│   └── 5.setup-mcp-config.sh
├── EKS 관련
│   ├── dmz_eks_shell.sh
│   ├── dmz_eksctl_shell.sh
│   └── dmz_eks_cleanup.sh
├── 추가 서비스
│   └── deploy-opensearch.sh
└── CloudFormation 템플릿
    ├── 1.DMZVPC.yml
    ├── 2.VPC01.yml
    ├── 3.VPC02.yml
    ├── 4.TGW.yml
    ├── aurora-mysql-stack.yml
    ├── redis-cluster-stack.yml
    └── opensearch-stack.yml
```

***

> ✅ 이제 이 실습 환경을 기반으로 Amazon Q CLI, MCP, VSCode 및 다양한 AI 개발 도구를 통합한 실전 실습을 진행해보세요!
