---
description: 'Update : 2025.07.20'
---

# 09.Q CLI κΈ°λ° ν”λ«νΌ μ΄μ ν™κ²½ μ„¤μ •

{% hint style="warning" %}
Amazon Q CLI κΈ°λ° ν”λ«νΌ μ΄μν•κΈ° λ©μ°¨λ¥Ό μν–‰ν•κΈ° μ„ν•΄μ„λ”, AWS μμ›μ΄ λ°°ν¬ λ©λ‹λ‹¤. λ”°λΌμ„ λΉ„μ©μ΄ λ°μƒν•  μ μκΈ° λ•λ¬Έμ— μ£Όμκ°€ ν•„μ”ν•©λ‹λ‹¤.
{% endhint %}

## π§© Amazon Q CLI μ‹¤μµ ν™κ²½ κµ¬μ„±

Amazon Q CLIμ κ³ κΈ‰ κΈ°λ¥μ„ μ‹¤μµν•  μ μλ” ν΄λΌμ°λ“ κΈ°λ° ν™κ²½μ„ μλ™μΌλ΅ κµ¬μ„±ν•©λ‹λ‹¤. λ„¤νΈμ›ν¬ μΈν”„λΌλ¶€ν„° κ°λ° λ„κµ¬, AI ν†µν•© λ„κµ¬(MCP)κΉμ§€ ν¬ν•¨λ μΆ…ν•©μ  ν•™μµ ν™κ²½μ…λ‹λ‹¤.

***

### π§ μ•„ν‚¤ν…μ² κµ¬μ„±

#### β… μ‹¤μµ μΈν”„λΌ ν™κ²½

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚    DMZ VPC      β”‚    β”‚     VPC01       β”‚    β”‚     VPC02       β”‚
β”‚  (Public/NAT)   β”‚    β”‚   (Private)     β”‚    β”‚   (Private)     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”
          β”‚                      β”‚                      β”‚
          β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                                 β”‚
                    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                    β”‚    Transit Gateway        β”‚
                    β”‚   (Cross-VPC Routing)     β”‚
                    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

#### β… μ„λΉ„μ¤ κµ¬μ„± μ”μ•½

* **DMZ VPC**: Public Subnet, NAT Gateway, Redis, OpenSearch (Option)
* **VPC01**: Private Subnet, Aurora MySQL
* **VPC02**: μ¶”κ°€ μ›ν¬λ΅λ“μ© Private Subnet
* **μ„ νƒμ‚¬ν•­**: Amazon EKS (K8s ν™κ²½)

***

### π§ λΉ λ¥Έ μ‹μ‘

#### β… μ €μ¥μ† ν΄λ΅  λ° μ΄λ™

```bash
git clone https://github.com/whchoi98/amazonqcli_lab.git
cd amazonqcli_lab/LabSetup
```

#### β… μΈν”„λΌ μλ™ λ°°ν¬

3κ°μ VPCλ¥Ό μ•„λμ™€ κ°™μ€ Shell Scriptλ΅ λ°°ν¬ν•©λ‹λ‹¤.&#x20;

ν•΄λ‹Ή Shell Scriptλ” 3κ°μ VPCλ¥Ό κµ¬μ„±ν•λ” Claudformation Stackμ„ λ™μ‹μ— λ°°ν¬ν•©λ‹λ‹¤. (DMZVPC, VPC01, VPC02)

```bash
./0.depoly-all-vpcs.sh     # λ³‘λ ¬ VPC λ°°ν¬

```

VPCκ°„μ μ—°κ²° κµ¬μ„±μ„ TGWλ¥Ό ν†µν•΄μ„ κµ¬μ„±ν•©λ‹λ‹¤.

ν•΄λ‹Ή Shell Scriptλ” λ°°ν¬λ 3κ°μ VPCλ¥Ό Transit Gatewayλ΅ μ—°κ²°ν•λ” Cloudformation Stackμ„ λ°°ν¬ν•©λ‹λ‹¤.

```
./0.deploy-tgw.sh          # Transit Gateway λ°°ν¬

```

β… κ°λ° ν™κ²½ κµ¬μ„±

μ•„λ κµ¬μ„±μ€ μ‹¤μµν™κ²½μ— ν•„μ”ν• ν™κ²½λ³€μμ™€ λ„κµ¬λ“¤ λ° KMSλ¥Ό μ„¤μΉν•λ” κ³Όμ •μ…λ‹λ‹¤.

```bash
./1.vscode-tools-installer.sh
./2.set-aws-env.sh
./3.kms-setup.sh
```

#### β… Amazon Q CLI λ° MCP μ„¤μ •

μ•„λ κµ¬μ„±μ€ μ΄ κ³Όμ •μ—μ„ ν•„μ”ν• μ£Όμ” MCP μ„¤μΉμ™€ ν™κ²½ κµ¬μ„±μ„ ν¬ν•¨ν•λ” Shell Script μ…λ‹λ‹¤.

```bash
./4.install_core_mcp.sh
./5.setup-mcp-config.sh
```

***

### π§ λ°°ν¬ κ°€μ΄λ“ μ”μ•½

#### π§ Phase 1: λ„¤νΈμ›ν‚Ή μΈν”„λΌ

**β… VPC κµ¬μ„± (0.depoly-all-vpcs.sh)**

* DMZ VPC: Public/NAT μ„λΈλ„·, IGW, NATGW, ANFW
* VPC01/VPC02: Private μ„λΈλ„·, λΌμ°ν… ν…μ΄λΈ”
* λ³‘λ ¬ λ°°ν¬, S3 μ—…λ΅λ“ ν¬ν•¨ λ° λ°°ν¬ ν›„ S3 μ‚­μ 

**β… Transit Gateway μ„¤μ • (0.deploy-tgw.sh)**

* TGW μƒμ„± λ° VPC μ—°κ²°
* TGW λΌμ°ν… ν…μ΄λΈ” μ„¤μ • - DMZVPC, VPC01, VPC02

#### π§ Phase 2: κ°λ° ν™κ²½

**β… κ°λ° λ„κµ¬ μ„¤μΉ (1.vscode-tools-installer.sh)**

* AWS CLI, kubectl, eksctl, helm, k9s
* jq, fzf, bash-completion λ“±

**β… AWS ν™κ²½ κµ¬μ„± (2.set-aws-env.sh)**

* ν”„λ΅νμΌ λ° λ¦¬μ „ λ³€μ μ„¤μ •

**β… KMS ν‚¤ κµ¬μ„± (3.kms-setup.sh)**

* μ•”νΈν™”μ© KMS ν‚¤ λ° λ³„μΉ­ κµ¬μ„±μΌλ΅ EKS λ°°ν¬μ‹ EBS μ•”νΈν™”λ¥Ό μ„ν•΄ μ„¤μ •

#### π§ Phase 3: Amazon Q CLI λ° MCP

**β… λ°νƒ€μ„ μ„¤μΉ (4.install\_core\_mcp.sh)**

* AWS MCP μ„¤μ •μ„ μ„ν• ν™κ²½ κµ¬μ„±μΌλ΅ Python 3.12, uv, Node.js μ„¤μΉλ¥Ό ν¬ν•¨ν•©λ‹λ‹¤.&#x20;

**β… MCP μ„λ²„ κµ¬μ„± (5.setup-mcp-config.sh)**

* MCP κµ¬μ„± νμΌ μƒμ„± (\~/.aws/amazonq/mcp.json)&#x20;
* Amazon Q CLIμ™€ μ—°λ™

***

### π§ μ„ νƒμ  μ„λΉ„μ¤ λ°°ν¬



```
./0.deploy-redis.sh
```

<table><thead><tr><th>π”— μ„λΉ„μ¤</th><th>π μ„μΉ</th><th>π–¥οΈ λ°°ν¬ μ¤ν¬λ¦½νΈ</th><th>π§Ύ ν…ν”λ¦Ώ</th></tr></thead><tbody><tr><td>Redis (ElastiCache)</td><td>DMZ VPC</td><td><code>./0.deploy-redis.sh</code></td><td><code>redis-cluster-stack.yml</code></td></tr><tr><td>Aurora MySQL</td><td>VPC01</td><td><code>./0.deploy-aurora.sh</code></td><td><code>aurora-mysql-stack.yml</code></td></tr><tr><td>OpenSearch</td><td>DMZ VPC</td><td><code>./deploy-opensearch.sh</code></td><td><code>opensearch-stack.yml</code></td></tr><tr><td>Amazon EKS</td><td>DMZ VPC</td><td><p></p><pre><code>./dmz_eks_shell.sh

# eksctl κµ¬μ„± λ° λ°°ν¬
./dmz_eksctl_shell.sh

# ν΄λ¬μ¤ν„° κµ¬μ„± ν™•μΈ (dry-run)
eksctl create cluster --config-file=/home/ec2-user/amazonqcli_lab/LabSetup/eksworkshop.yaml --dry-run

# μ‹¤μ  ν΄λ¬μ¤ν„° μƒμ„±
eksctl create cluster --config-file=/home/ec2-user/amazonqcli_lab/LabSetup/eksworkshop.yaml
</code></pre></td><td><code>eksworkshop.yaml</code></td></tr></tbody></table>

***

### π§ λ””λ ‰ν„°λ¦¬ κµ¬μ΅°

```
LabSetup/
β”β”€β”€ λ°°ν¬ μ¤ν¬λ¦½νΈ
β”‚   β”β”€β”€ 0.depoly-all-vpcs.sh
β”‚   β”β”€β”€ 0.deploy-tgw.sh
β”‚   β”β”€β”€ 0.deploy-redis.sh
β”‚   β””β”€β”€ 0.deploy-aurora.sh
β”β”€β”€ ν™κ²½ μ„¤μ •
β”‚   β”β”€β”€ 1.vscode-tools-installer.sh
β”‚   β”β”€β”€ 2.set-aws-env.sh
β”‚   β””β”€β”€ 3.kms-setup.sh
β”β”€β”€ MCP λ° Q CLI μ„¤μ •
β”‚   β”β”€β”€ 4.install_core_mcp.sh
β”‚   β””β”€β”€ 5.setup-mcp-config.sh
β”β”€β”€ EKS κ΄€λ ¨
β”‚   β”β”€β”€ dmz_eks_shell.sh
β”‚   β”β”€β”€ dmz_eksctl_shell.sh
β”‚   β””β”€β”€ dmz_eks_cleanup.sh
β”β”€β”€ μ¶”κ°€ μ„λΉ„μ¤
β”‚   β””β”€β”€ deploy-opensearch.sh
β””β”€β”€ CloudFormation ν…ν”λ¦Ώ
    β”β”€β”€ 1.DMZVPC.yml
    β”β”€β”€ 2.VPC01.yml
    β”β”€β”€ 3.VPC02.yml
    β”β”€β”€ 4.TGW.yml
    β”β”€β”€ aurora-mysql-stack.yml
    β”β”€β”€ redis-cluster-stack.yml
    β””β”€β”€ opensearch-stack.yml
```

***

> β… μ΄μ  μ΄ μ‹¤μµ ν™κ²½μ„ κΈ°λ°μΌλ΅ Amazon Q CLI, MCP, VSCode λ° λ‹¤μ–‘ν• AI κ°λ° λ„κµ¬λ¥Ό ν†µν•©ν• μ‹¤μ „ μ‹¤μµμ„ μ§„ν–‰ν•΄λ³΄μ„Έμ”!
