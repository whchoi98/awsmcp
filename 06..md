# 06. 코드베이스 이해하기

### Overview

이 실습에서는 지금까지 구축한 애플리케이션을 바탕으로 코드베이스를 문서화하여, 향후 개발자들이 이 코드베이스를 더 잘 이해할 수 있도록 만드는 방법을 살펴봅니다.

***

### Task 01 – 코드 구조 분석하기

Amazon Q CLI는 처음 접하는 코드베이스를 탐색할 때 매우 유용한 도구입니다. 전체 애플리케이션의 구조를 설명하거나, 특정 함수나 클래스에 대해 심층 분석할 수 있습니다.

1. 먼저 프로젝트 디렉토리 내 README.md 파일을 삭제합니다.
2. Amazon Q CLI를 실행하고, 프롬프트에서 다음 명령어를 입력합니다:

```
> Explore the codebase in the current project workspace. I want you to explain the key architecture components of this application, and then walk me through how it works.
```

3. 추가적으로 특정 기능을 깊이 이해하고 싶다면 다음과 같이 입력합니다:

```
> can you provide indepth and deep explaination of how the authorization works in this codebase. Go level 500
```

4. 출력 내용을 확인하며, Amazon Q CLI가 어떤 방식으로 파일을 탐색하고 설명하는지 확인합니다.
5. 마지막으로 다음 명령어로 사용 중인 컨텍스트와 토큰 수를 확인해봅니다:

```
> /usage
```

대규모 코드베이스의 경우, 탐색 범위를 축소하지 않으면 Amazon Q CLI가 처리할 수 있는 토큰 한도를 초과할 수 있으므로 주의가 필요합니다.

***

### Task 02 – ERD 및 UML 시퀀스 다이어그램 생성

코드베이스의 이해도를 높이기 위해 시각적인 다이어그램은 매우 유용합니다. Amazon Q CLI는 ERD 및 UML 시퀀스 다이어그램을 Markdown 기반으로 생성할 수 있습니다.

1. ERD(Entity Relationship Diagram)를 생성하려면 다음을 입력합니다:

```
> Generate an ERD for the data model in this application. Create it in a new mardown document called "data-model.md"
```

2. UML 시퀀스 다이어그램을 생성하려면 다음 명령어를 사용합니다:

```
> Generate a UML sequence diagram for the user registration and login process. Add this to the README.md file.
```

VSCode 사용자라면 “Enhanced Markdown Viewer” 확장 기능을 사용해 Marmaid 다이어그램을 시각적으로 확인할 수 있습니다.

***

### Task 03 – 오픈소스 코드베이스 분석

Amazon Q CLI를 활용해 외부 오픈소스 코드도 분석할 수 있습니다.

1. 새로운 임시 디렉토리를 만들고 이동합니다:

```
mkdir qcli-oss
cd qcli-oss
```

2. Amazon Q CLI의 GitHub 리포지토리를 클론합니다:

```
git clone https://github.com/aws/amazon-q-developer-cli.git
cd amazon-q-developer-cli
```

3. Amazon Q CLI를 실행하고, 다음 프롬프트를 입력합니다:

```
> Can you review the code and tell me how to configure mcp.settings
```

출력 예시:

```
{
  "mcpServers": {
    "myTool": {
      "command": "/usr/local/bin/my-mcp-tool",
      "args": ["--verbose"],
      "env": {
        "API_KEY": "your-api-key"
      },
      "timeout": 60000
    }
  }
}
```

***

### Task 04 – 도구 기능 분석하기

Amazon Q CLI에 포함된 qterm 도구가 무엇을 하는지 궁금했다면 다음 프롬프트를 입력해보세요:

```
> Review the codebase and explain what qterm does
```

Amazon Q CLI가 qterm의 동작 방식 및 역할을 상세히 설명해줄 것입니다.

***

### 마무리 및 정리

이번 실습에서는 Amazon Q CLI를 활용하여 코드베이스를 이해하고, 구조 및 동작 원리를 문서화하는 과정을 수행했습니다. 다음 정리 작업을 진행해 주세요:

* aqcli-app 프로젝트 디렉토리 삭제
* .aws/amazonq/mcp.json 등 설정 파일 정리

